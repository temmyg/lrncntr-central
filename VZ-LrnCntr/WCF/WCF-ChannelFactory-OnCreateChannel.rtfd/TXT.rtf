{\rtf1\ansi\ansicpg1252\cocoartf1671\cocoasubrtf600
{\fonttbl\f0\fswiss\fcharset0 Helvetica;\f1\fnil\fcharset0 Tahoma;\f2\fnil\fcharset134 PingFangSC-Regular;
\f3\froman\fcharset0 Times-Roman;\f4\fnil\fcharset0 Tahoma-Bold;\f5\fmodern\fcharset0 CourierNewPSMT;
}
{\colortbl;\red255\green255\blue255;\red38\green38\blue38;\red255\green255\blue255;\red200\green200\blue200;
\red255\green242\blue10;\red158\green158\blue158;\red41\green101\blue168;\red48\green48\blue48;\red0\green0\blue0;
\red102\green194\blue236;\red19\green112\blue189;\red0\green0\blue255;\red37\green127\blue159;\red240\green240\blue240;
\red144\green1\blue18;}
{\*\expandedcolortbl;;\cssrgb\c20000\c20000\c20000;\cssrgb\c100000\c100000\c100000;\cssrgb\c82353\c82353\c82353;
\cssrgb\c100000\c94510\c0;\cssrgb\c68235\c68235\c68235;\cssrgb\c20000\c47843\c71765;\cssrgb\c24706\c24706\c24706;\cssrgb\c0\c0\c0;
\cssrgb\c46275\c80392\c94118;\cssrgb\c5490\c52157\c78824;\cssrgb\c0\c0\c100000;\cssrgb\c16863\c56863\c68627;\cssrgb\c95294\c95294\c95294;
\cssrgb\c63922\c8235\c8235;}
{\*\listtable{\list\listtemplateid1\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{none\}}{\leveltext\leveltemplateid1\'00;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid1}
{\list\listtemplateid2\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid101\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid2}
{\list\listtemplateid3\listhybrid{\listlevel\levelnfc0\levelnfcn0\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{decimal\}.}{\leveltext\leveltemplateid201\'02\'00.;}{\levelnumbers\'01;}\fi-360\li720\lin720 }{\listname ;}\listid3}
{\list\listtemplateid4\listhybrid{\listlevel\levelnfc0\levelnfcn0\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{decimal\}.}{\leveltext\leveltemplateid301\'02\'00.;}{\levelnumbers\'01;}\fi-360\li720\lin720 }{\listname ;}\listid4}
{\list\listtemplateid5\listhybrid{\listlevel\levelnfc0\levelnfcn0\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{decimal\}.}{\leveltext\leveltemplateid401\'02\'00.;}{\levelnumbers\'01;}\fi-360\li720\lin720 }{\listname ;}\listid5}
{\list\listtemplateid6\listhybrid{\listlevel\levelnfc0\levelnfcn0\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{decimal\}.}{\leveltext\leveltemplateid501\'02\'00.;}{\levelnumbers\'01;}\fi-360\li720\lin720 }{\listname ;}\listid6}
{\list\listtemplateid7\listhybrid{\listlevel\levelnfc0\levelnfcn0\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{decimal\}.}{\leveltext\leveltemplateid601\'02\'00.;}{\levelnumbers\'01;}\fi-360\li720\lin720 }{\listname ;}\listid7}
{\list\listtemplateid8\listhybrid{\listlevel\levelnfc0\levelnfcn0\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{decimal\}.}{\leveltext\leveltemplateid701\'02\'00.;}{\levelnumbers\'01;}\fi-360\li720\lin720 }{\listname ;}\listid8}
{\list\listtemplateid9\listhybrid{\listlevel\levelnfc0\levelnfcn0\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{decimal\}.}{\leveltext\leveltemplateid801\'02\'00.;}{\levelnumbers\'01;}\fi-360\li720\lin720 }{\listname ;}\listid9}
{\list\listtemplateid10\listhybrid{\listlevel\levelnfc0\levelnfcn0\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{decimal\}.}{\leveltext\leveltemplateid901\'02\'00.;}{\levelnumbers\'01;}\fi-360\li720\lin720 }{\listname ;}\listid10}
{\list\listtemplateid11\listhybrid{\listlevel\levelnfc0\levelnfcn0\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{decimal\}.}{\leveltext\leveltemplateid1001\'02\'00.;}{\levelnumbers\'01;}\fi-360\li720\lin720 }{\listname ;}\listid11}}
{\*\listoverridetable{\listoverride\listid1\listoverridecount0\ls1}{\listoverride\listid2\listoverridecount0\ls2}{\listoverride\listid3\listoverridecount0\ls3}{\listoverride\listid4\listoverridecount0\ls4}{\listoverride\listid5\listoverridecount0\ls5}{\listoverride\listid6\listoverridecount0\ls6}{\listoverride\listid7\listoverridecount0\ls7}{\listoverride\listid8\listoverridecount0\ls8}{\listoverride\listid9\listoverridecount0\ls9}{\listoverride\listid10\listoverridecount0\ls10}{\listoverride\listid11\listoverridecount0\ls11}}
\paperw11900\paperh16840\margl1440\margr1440\vieww10800\viewh8400\viewkind0
\pard\tx720\tx1440\tx2160\tx2880\tx3600\tx4320\tx5040\tx5760\tx6480\tx7200\tx7920\tx8640\pardirnatural\partightenfactor0

\f0\fs24 \cf0 Adfasfads
\f1\fs72 \cf2 \cb3 \expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 WCF Extensibility \'96 Channels\cb1 \
\pard\pardeftab720\sl320\qr\partightenfactor0

\f2\fs33\fsmilli16800 \cf4 \cb3 \strokec4 \'a1\'ef\'a1\'ef\'a1\'ef\'a1\'ef\'a1\'ef
\f1 \cb1 \
\pard\pardeftab720\sl320\qr\partightenfactor0

\f2 \cf5 \cb3 \strokec5 \'a1\'ef\'a1\'ef\'a1\'ef\'a1\'ef
\f1 \cb1 \

\f2 \cb3 \'a1\'ef\'a1\'ef\'a1\'ef
\f1 \cb1 \

\f2 \cb3 \'a1\'ef\'a1\'ef
\f1 \cb1 \

\f2 \cb3 \'a1\'ef
\f1 \cb1 \
\pard\pardeftab720\sl340\partightenfactor0

\fs28 \cf2 \strokec2 \
\pard\pardeftab720\sl320\partightenfactor0

\fs26 \cf6 \strokec6 \pard\pardeftab720\sl320\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://social.msdn.microsoft.com/profile/CarlosFigueira"}}{\fldrslt \cf7 \cb3 \strokec7 CarlosFigueira}}\cb3 July 11, 2011\
\pard\pardeftab720\sl440\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://blogs.msdn.microsoft.com/carlosfigueira/2011/07/11/wcf-extensibility-channels/#comments"}}{\fldrslt 
\fs36 \cf8 \strokec8 7}}\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl280\partightenfactor0
\ls1\ilvl0
\f3\fs24 \cf9 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \uc0\u8232 \u8232 
\f1\fs28\fsmilli14400 \cf6 \strokec6 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl560\partightenfactor0
\ls1\ilvl0\cf3 \cb10 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		{\field{\*\fldinst{HYPERLINK "https://blogs.msdn.microsoft.com/carlosfigueira/2011/07/11/wcf-extensibility-channels/#"}}{\fldrslt \expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec3 0}}\cb1 \expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec3 \uc0\u8232 \cf6 \cb10 \strokec6 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl560\partightenfactor0
\ls1\ilvl0\cf3 \cb11 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		{\field{\*\fldinst{HYPERLINK "https://blogs.msdn.microsoft.com/carlosfigueira/2011/07/11/wcf-extensibility-channels/#"}}{\fldrslt \expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec3 0}}\cb1 \expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec3 \uc0\u8232 \cf6 \cb11 \strokec6 \
\pard\pardeftab720\ri4856\sl340\sa400\partightenfactor0

\fs28 \cf2 \cb1 \strokec2 \
\pard\pardeftab720\sl340\sa200\partightenfactor0
\cf2 \cb3 This post is part of a series about WCF extensibility points. For a list of all previous posts and planned future ones, go to the\'a0{\field{\*\fldinst{HYPERLINK "http://blogs.msdn.com/b/carlosfigueira/archive/2011/03/14/wcf-extensibility.aspx"}}{\fldrslt \cf7 \strokec7 index page}}.\cb1 \
\cb3 Channels are possibly the most fundamental concept in WCF that (almost) nobody knows about. This is quite a heavy subject, so I\'92ll break it down in two parts: this post will deal with the concepts for channels and the client part, and the next one will dive deeper into the server part of the channels.\cb1 \
\cb3 Channels (also known as \'93protocol channels\'94) make up the stack over which WCF messages are sent and received. They are called \'93protocol channels\'94 because they\'92re usually used to implement some sort of, well, protocol between the communicating parties. Security (WS-Security), reliable messaging (WS-RM), transactions (WS-Transaction), composite duplex (where two HTTP connections are used to implement a duplex pattern over HTTP, which is a request/reply protocol), those are all implemented as channels in WCF. Other examples, such as the\'a0{\field{\*\fldinst{HYPERLINK "http://msdn.microsoft.com/en-us/library/cc645026(VS.95).aspx"}}{\fldrslt \cf7 \strokec7 Polling Duplex}}\'a0protocol from Silverlight, or the chunking protocol implemented by the\'a0{\field{\*\fldinst{HYPERLINK "http://msdn.microsoft.com/en-us/library/aa717050.aspx"}}{\fldrslt \cf7 \strokec7 Chunking Channel sample}}\'a0are also implemented internally as channels. Channels can do essentially anything with the message: change it, add / remove headers, fiddle with its properties, invoke user code (which I used on the post about\'a0{\field{\*\fldinst{HYPERLINK "http://blogs.msdn.com/b/carlosfigueira/archive/2011/06/21/wcf-extensibility-extensibility-in-windows-phone-and-silverlight-3.aspx"}}{\fldrslt \cf7 \strokec7 extensibility points for Windows Phone / Silverlight 3}}), even change the message completely. The channel then passes the message to the \'93inner\'94 channel until it reaches the final destination - for outgoing messages (the request on the client side, the reply on the server), it\'92s the transport which will send the message over the wire; for incoming messages (request on server, reply on client), it\'92s the formatter which will unwrap the parameters out of the message to either call the service operation or send the result back to the client code. The diagram below has been drawn in many similar ways and shapes, but it illustrates quite well the path that a request takes from the client to the server (for the response, just invert the direction of the vertical arrows).\cb1 \
\pard\pardeftab720\sl340\sa200\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://msdnshared.blob.core.windows.net/media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/95/96/metablogapi/1348.Channels_2E5A7836.png"}}{\fldrslt \cf7 \strokec7 }}\pard\pardeftab720\sl340\sa200\partightenfactor0
\cf2 \
\pard\pardeftab720\sl340\sa200\partightenfactor0
\cf2 \cb3 But this diagram doesn\'92t even tell everything that a channel can do: it doesn\'92t have to receive one message, play with it and pass it along. It can take one message, then send several of them \'96 for example, a very time-sensitive client can send multiple requests to different services, and take the first response thus reducing the odds it will hit a dead server. It can, even before a client sends a request, to do some communication with the server side \'96 the protocol can do some handshaking when the channel is being\'a0opened\'a0(and also do some teardown handshaking when the channel is being closed). It can even\'a0not send the message to the inner channel\'a0\'96 and thus bypass the whole stack returning a message directly to the caller. The same can be done for incoming messages as well \'96 a channel can simply inspect / modify the incoming message and pass it along, it can collect many messages and aggregate them into a single message to pass it along (like in the\'a0{\field{\*\fldinst{HYPERLINK "http://msdn.microsoft.com/en-us/library/aa717050.aspx"}}{\fldrslt \cf7 \strokec7 Chunking Channel sample}}), or it can simply deal with the message directly without passing it along (in the case of handshaking messages, for example). Channels can also be used where the \'93normal\'94 extensibility points don\'92t work, for example, to\'a0{\field{\*\fldinst{HYPERLINK "http://social.msdn.microsoft.com/Forums/en-US/wcf/thread/21b77052-2b6e-439c-80b6-83607393edb2"}}{\fldrslt \cf7 \strokec7 catch errors in the channels themselves}}, outside of the service model realm.\cb1 \
\cb3 One aside about encoders:\'a0{\field{\*\fldinst{HYPERLINK "http://marwanabdelhady.blogspot.com/2010/11/wcf.html"}}{\fldrslt \cf7 \strokec7 many}}\'a0{\field{\*\fldinst{HYPERLINK "http://cgeers.com/2008/11/09/wcf-extensibility-parameter-inspectors/"}}{\fldrslt \cf7 \strokec7 diagrams}}\'a0{\field{\*\fldinst{HYPERLINK "http://wgao.blogspot.com/2007/11/wcf-binding.html"}}{\fldrslt \cf7 \strokec7 for}}\'a0{\field{\*\fldinst{HYPERLINK "http://soya.sourceforge.net/system-design.html"}}{\fldrslt \cf7 \strokec7 channels}}\'a0in WCF put them in the same category as the other channels. In fact, they should not be considered as such. On outgoing messages, the last protocol channel in the stack doesn\'92t hand its message to the encoder for processing \'96 it hands it over to the last channel in the stack, the transport channel. It\'92s the transport which\'a0
\f4\b may
\f1\b0 \'a0use an encoder in the binding context to convert the message into bytes to send over the wire (it doesn\'92t have to, it can do the encoding itself if the implementation so desires). Similarly for incoming messages, the transport may use the encoder to decode the bytes into a Message object, and then it passes it along to the next protocol channel in the stack. I\'92ll cover encoders in more details in an upcoming post about them.\cb1 \
\pard\pardeftab720\sl520\sa200\partightenfactor0

\fs48 \cf2 \cb3 Channel Shapes\cb1 \
\pard\pardeftab720\sl340\sa200\partightenfactor0

\fs28 \cf2 \cb3 There are many different shapes (or kinds) of channels in the WCF pipeline. Depending on the\'a0{\field{\*\fldinst{HYPERLINK "http://msdn.microsoft.com/en-us/library/aa751829.aspx"}}{\fldrslt \cf7 \strokec7 message exchanging pattern}}\'a0which is being used, a certain kind of channel needs to be used, so the type of custom channel you need to write will be determined by the pattern as well. The list below shows briefly the types of WCF channels:\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl340\partightenfactor0
\ls2\ilvl0\cf7 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}{\field{\*\fldinst{HYPERLINK "http://msdn.microsoft.com/en-us/library/system.servicemodel.channels.ioutputchannel.aspx"}}{\fldrslt \expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec7 IOutputChannel}}\cf2 \expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 : Defines a channel which can only send messages. Useful in one-way communication.\cb1 \
\ls2\ilvl0\cf7 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}{\field{\*\fldinst{HYPERLINK "http://msdn.microsoft.com/en-us/library/system.servicemodel.channels.iinputchannel.aspx"}}{\fldrslt \expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec7 IInputChannel}}\cf2 \expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 : The receiving counterpart of the IOutputChannel, defines a channel which can only receive messages\cb1 \
\ls2\ilvl0\cf7 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}{\field{\*\fldinst{HYPERLINK "http://msdn.microsoft.com/en-us/library/system.servicemodel.channels.irequestchannel.aspx"}}{\fldrslt \expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec7 IRequestChannel}}\cf2 \expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 : Defines a channel which can send a message, and return a response to it. Useful in request/reply protocols such as HTTP\cb1 \
\ls2\ilvl0\cf7 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}{\field{\*\fldinst{HYPERLINK "http://msdn.microsoft.com/en-us/library/system.servicemodel.channels.ireplychannel.aspx"}}{\fldrslt \expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec7 IReplyChannel}}\cf2 \expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 : The receiving counterpart of the IRequestChannel, defines a channel which can receive a request and reply with another message\cb1 \
\ls2\ilvl0\cf7 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}{\field{\*\fldinst{HYPERLINK "http://msdn.microsoft.com/en-us/library/system.servicemodel.channels.iduplexchannel.aspx"}}{\fldrslt \expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec7 IDuplexChannel}}\cf2 \expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 : Defines a channel which can both send and receive messages independently. A duplex channel is equivalent to a pair of IInputChannel and IOutputChannel.\cb1 \
\pard\pardeftab720\sl340\sa200\partightenfactor0
\cf2 \cb3 In addition to those basic shapes, there are also their session-full equivalent which extend their contract by also implementing\'a0{\field{\*\fldinst{HYPERLINK "http://msdn.microsoft.com/en-us/library/ms596746.aspx"}}{\fldrslt \cf7 \strokec7 ISessionChannel}}\'a0to support session-full communication:\'a0{\field{\*\fldinst{HYPERLINK "http://msdn.microsoft.com/en-us/library/system.servicemodel.channels.ioutputsessionchannel.aspx"}}{\fldrslt \cf7 \strokec7 IOutputSessionChannel}},\'a0{\field{\*\fldinst{HYPERLINK "http://msdn.microsoft.com/en-us/library/system.servicemodel.channels.iinputsessionchannel.aspx"}}{\fldrslt \cf7 \strokec7 IInputSessionChannel}},\'a0{\field{\*\fldinst{HYPERLINK "http://msdn.microsoft.com/en-us/library/system.servicemodel.channels.irequestsessionchannel.aspx"}}{\fldrslt \cf7 \strokec7 IRequestSessionChannel}},\'a0{\field{\*\fldinst{HYPERLINK "http://msdn.microsoft.com/en-us/library/system.servicemodel.channels.ireplysessionchannel.aspx"}}{\fldrslt \cf7 \strokec7 IReplySessionChannel}}\'a0and\'a0{\field{\*\fldinst{HYPERLINK "http://msdn.microsoft.com/en-us/library/system.servicemodel.channels.iduplexsessionchannel.aspx"}}{\fldrslt \cf7 \strokec7 IDuplexSessionChannel}}.\cb1 \
\cb3 Notice that the channels in the stack don\'92t need to be all of the same shape: it\'92s possible that protocol channels are used to modify the shape of the communication as well. For example, the composite duplex channel (used in the\'a0{\field{\*\fldinst{HYPERLINK "http://msdn.microsoft.com/en-us/library/system.servicemodel.wsdualhttpbinding.aspx"}}{\fldrslt \cf7 \strokec7 WSDualHttpBinding}}) converts an output (in the sender) and input (in the receiver) channels into a duplex channel (a duplex session channel, actually), by essentially creating a \'93server\'94 at the client side. The reliable messaging channel, used in\'a0{\field{\*\fldinst{HYPERLINK "http://msdn.microsoft.com/en-us/library/system.servicemodel.wshttpbinding.aspx"}}{\fldrslt \cf7 \strokec7 WSHttpBinding}}, adds a session to the HTTP transport (essentially transforming an IRequestChannel into an IRequestSessionChannel at the client, and an IReplyChannel into an IReplySessionChannel at the server). And so on.\cb1 \
\cb3 So, channels are very powerful, very flexible, and can do a lot of nice features. Why aren\'92t they used more widely then? First of all, they\'92re difficult to implement. Even for simple channels which just pass along a message to the inner channel and don\'92t do anything like shape changing, there is a lot of code which needs to be written (in the example later in this post you\'92ll see what I\'92m talking about). Also, channels deal with\'a0{\field{\*\fldinst{HYPERLINK "http://msdn.microsoft.com/en-us/library/system.servicemodel.channels.message.aspx"}}{\fldrslt \cf7 \strokec7 Message}}\'a0objects. Unless one is very versed in SOAP-speak, chances are they just want to define a service and let WCF (or whichever stack they\'92re using) take care of the protocols underneath. And start throwing asynchronous code paths which can be used, the implementation of even the simplest of the channels can become complex quickly. So most people (with very good reason), myself included, avoid going down to the channel level unless it\'92s absolutely necessary.\cb1 \
\pard\pardeftab720\sl520\sa200\partightenfactor0

\fs48 \cf2 \cb3 Public implementations in WCF\cb1 \
\pard\pardeftab720\sl340\sa200\partightenfactor0

\fs28 \cf2 \cb3 None. All channels in WCF (and in most examples I\'92ve seen) are implemented either as internal or nested (private) classes of the binding elements which add them. Since the channels can only be created following a certain pattern (the binding element creates the channel factory / listener, then the factory / listener creates the appropriate channel), it doesn\'92t make sense for those classes to be public (maybe with the exception for unit testing purposes)\cb1 \
\pard\pardeftab720\sl520\sa200\partightenfactor0

\fs48 \cf2 \cb3 Interface declarations\cb1 \
\pard\pardeftab720\sl340\sa200\partightenfactor0

\fs28 \cf2 \cb3 The interfaces for the channel shapes have so many methods that I\'92ll skip this section in this post \'96 follow the links on the channel shapes section for them.\cb1 \
\pard\pardeftab720\sl520\sa200\partightenfactor0

\fs48 \cf2 \cb3 How to add custom channels (client side)\cb1 \
\pard\pardeftab720\sl340\sa200\partightenfactor0

\fs28 \cf2 \cb3 Channels stacks are created using the factory pattern from the binding. So to create a custom channel, one needs to write a\'a0{\field{\*\fldinst{HYPERLINK "http://msdn.microsoft.com/en-us/library/system.servicemodel.channels.bindingelement.aspx"}}{\fldrslt \cf7 \strokec7 binding element}}, and create a binding containing this element. The binding element class would override\'a0{\field{\*\fldinst{HYPERLINK "http://msdn.microsoft.com/en-us/library/ms405436.aspx"}}{\fldrslt \cf7 \strokec7 CanBuildChannelFactory<TChannel>}}\'a0(to determine whether the channel shape is supported) and\'a0{\field{\*\fldinst{HYPERLINK "http://msdn.microsoft.com/en-us/library/ms405434.aspx"}}{\fldrslt \cf7 \strokec7 BuildChannelFactory<TChannel>}}\'a0to actually return a channel factory which is capable of building the requested channel type. The channel factory implementation needs to override the CreateChannel methods (or\'a0{\field{\*\fldinst{HYPERLINK "http://msdn.microsoft.com/en-us/library/ms405470.aspx"}}{\fldrslt \cf7 \strokec7 OnCreateChannel}}, if the class inherits from\'a0{\field{\*\fldinst{HYPERLINK "http://msdn.microsoft.com/en-us/library/ms405827.aspx"}}{\fldrslt \cf7 \strokec7 ChannelFactoryBase<TChannel>}}), besides a lot of boilerplate methods (Open, BeginOpen, EndOpen, Close, etc.) to finally return the channel which will be used in the pipeline. To illustrate the verboseness of all of this, this is I think the simplest code to write a client channel that I can think of (it just passes the message along, and supports only\'a0{\field{\*\fldinst{HYPERLINK "http://msdn.microsoft.com/en-us/library/system.servicemodel.channels.irequestchannel.aspx"}}{\fldrslt \cf7 \strokec7 IRequestChannel}}).\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0
\f5\fs26\fsmilli13333 \cf12 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	1.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec12 public\cf9 \strokec9 \'a0\cf12 \strokec12 class\cf9 \strokec9 \'a0\cf13 \strokec13 MyBindingElement\cf9 \strokec9 \'a0:\'a0\cf13 \strokec13 BindingElement\cf9 \cb1 \strokec9 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	2.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \{\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	3.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\cf12 \strokec12 public\cf9 \strokec9 \'a0\cf12 \strokec12 override\cf9 \strokec9 \'a0\cf13 \strokec13 BindingElement\cf9 \strokec9 \'a0Clone()\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	4.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\{\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	5.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 return\cf9 \strokec9 \'a0\cf12 \strokec12 new\cf9 \strokec9 \'a0\cf13 \strokec13 MyBindingElement\cf9 \strokec9 ();\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	6.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\}\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	7.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	8.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\cf12 \strokec12 public\cf9 \strokec9 \'a0\cf12 \strokec12 override\cf9 \strokec9 \'a0T GetProperty<T>(\cf13 \strokec13 BindingContext\cf9 \strokec9 \'a0context)\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	9.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\{\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	10.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 return\cf9 \strokec9 \'a0context.GetInnerProperty<T>();\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	11.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\}\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	12.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	13.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\cf12 \strokec12 public\cf9 \strokec9 \'a0\cf12 \strokec12 override\cf9 \strokec9 \'a0\cf12 \strokec12 bool\cf9 \strokec9 \'a0CanBuildChannelFactory<TChannel>(\cf13 \strokec13 BindingContext\cf9 \strokec9 \'a0context)\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	14.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\{\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	15.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 return\cf9 \strokec9 \'a0\cf12 \strokec12 typeof\cf9 \strokec9 (TChannel) ==\'a0\cf12 \strokec12 typeof\cf9 \strokec9 (\cf13 \strokec13 IRequestChannel\cf9 \strokec9 ) &&\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	16.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0context.CanBuildInnerChannelFactory<TChannel>();\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	17.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\}\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	18.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	19.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\cf12 \strokec12 public\cf9 \strokec9 \'a0\cf12 \strokec12 override\cf9 \strokec9 \'a0\cf13 \strokec13 IChannelFactory\cf9 \strokec9 <TChannel> BuildChannelFactory<TChannel>(\cf13 \strokec13 BindingContext\cf9 \strokec9 \'a0context)\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	20.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\{\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	21.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 if\cf9 \strokec9 \'a0(\cf12 \strokec12 typeof\cf9 \strokec9 (TChannel) !=\'a0\cf12 \strokec12 typeof\cf9 \strokec9 (\cf13 \strokec13 IRequestChannel\cf9 \strokec9 ))\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	22.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\{\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	23.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 throw\cf9 \strokec9 \'a0\cf12 \strokec12 new\cf9 \strokec9 \'a0\cf13 \strokec13 InvalidOperationException\cf9 \strokec9 (\cf15 \strokec15 "Only IRequestChannel is supported"\cf9 \strokec9 );\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	24.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\}\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	25.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	26.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 var\cf9 \strokec9 \'a0factory =\'a0\cf12 \strokec12 new\cf9 \strokec9 \'a0\cf13 \strokec13 MyFactory\cf9 \strokec9 (context.BuildInnerChannelFactory<\cf13 \strokec13 IRequestChannel\cf9 \strokec9 >());\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	27.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 return\cf9 \strokec9 \'a0(\cf13 \strokec13 IChannelFactory\cf9 \strokec9 <TChannel>)factory;\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	28.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\}\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	29.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	30.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\cf12 \strokec12 class\cf9 \strokec9 \'a0\cf13 \strokec13 MyFactory\cf9 \strokec9 \'a0:\'a0\cf13 \strokec13 ChannelFactoryBase\cf9 \strokec9 <\cf13 \strokec13 IRequestChannel\cf9 \strokec9 >\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	31.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\{\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	32.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf13 \strokec13 IChannelFactory\cf9 \strokec9 <\cf13 \strokec13 IRequestChannel\cf9 \strokec9 > innerFactory;\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	33.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 public\cf9 \strokec9 \'a0MyFactory(\cf13 \strokec13 IChannelFactory\cf9 \strokec9 <\cf13 \strokec13 IRequestChannel\cf9 \strokec9 > innerFactory)\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	34.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\{\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	35.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 this\cf9 \strokec9 .innerFactory = innerFactory;\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	36.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\}\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	37.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	38.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 protected\cf9 \strokec9 \'a0\cf12 \strokec12 override\cf9 \strokec9 \'a0\cf13 \strokec13 IRequestChannel\cf9 \strokec9 \'a0OnCreateChannel(\cf13 \strokec13 EndpointAddress\cf9 \strokec9 \'a0address,\'a0\cf13 \strokec13 Uri\cf9 \strokec9 \'a0via)\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	39.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\{\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	40.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 return\cf9 \strokec9 \'a0\cf12 \strokec12 new\cf9 \strokec9 \'a0\cf13 \strokec13 MyChannel\cf9 \strokec9 (\cf12 \strokec12 this\cf9 \strokec9 ,\'a0\cf12 \strokec12 this\cf9 \strokec9 .innerFactory.CreateChannel(address, via));\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	41.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\}\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	42.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	43.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 protected\cf9 \strokec9 \'a0\cf12 \strokec12 override\cf9 \strokec9 \'a0\cf13 \strokec13 IAsyncResult\cf9 \strokec9 \'a0OnBeginOpen(\cf13 \strokec13 TimeSpan\cf9 \strokec9 \'a0timeout,\'a0\cf13 \strokec13 AsyncCallback\cf9 \strokec9 \'a0callback,\'a0\cf12 \strokec12 object\cf9 \strokec9 \'a0state)\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	44.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\{\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	45.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 return\cf9 \strokec9 \'a0\cf12 \strokec12 this\cf9 \strokec9 .innerFactory.BeginOpen(timeout, callback, state);\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	46.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\}\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	47.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	48.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 protected\cf9 \strokec9 \'a0\cf12 \strokec12 override\cf9 \strokec9 \'a0\cf12 \strokec12 void\cf9 \strokec9 \'a0OnEndOpen(\cf13 \strokec13 IAsyncResult\cf9 \strokec9 \'a0result)\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	49.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\{\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	50.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 this\cf9 \strokec9 .innerFactory.EndOpen(result);\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	51.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\}\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	52.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	53.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 protected\cf9 \strokec9 \'a0\cf12 \strokec12 override\cf9 \strokec9 \'a0\cf12 \strokec12 void\cf9 \strokec9 \'a0OnOpen(\cf13 \strokec13 TimeSpan\cf9 \strokec9 \'a0timeout)\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	54.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\{\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	55.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 this\cf9 \strokec9 .innerFactory.Open(timeout);\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	56.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\}\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	57.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	58.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 protected\cf9 \strokec9 \'a0\cf12 \strokec12 override\cf9 \strokec9 \'a0\cf12 \strokec12 void\cf9 \strokec9 \'a0OnAbort()\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	59.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\{\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	60.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 this\cf9 \strokec9 .innerFactory.Abort();\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	61.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\}\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	62.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	63.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 public\cf9 \strokec9 \'a0\cf12 \strokec12 override\cf9 \strokec9 \'a0T GetProperty<T>()\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	64.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\{\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	65.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 return\cf9 \strokec9 \'a0\cf12 \strokec12 this\cf9 \strokec9 .innerFactory.GetProperty<T>();\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	66.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\}\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	67.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	68.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 protected\cf9 \strokec9 \'a0\cf12 \strokec12 override\cf9 \strokec9 \'a0\cf13 \strokec13 IAsyncResult\cf9 \strokec9 \'a0OnBeginClose(\cf13 \strokec13 TimeSpan\cf9 \strokec9 \'a0timeout,\'a0\cf13 \strokec13 AsyncCallback\cf9 \strokec9 \'a0callback,\'a0\cf12 \strokec12 object\cf9 \strokec9 \'a0state)\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	69.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\{\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	70.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 return\cf9 \strokec9 \'a0\cf12 \strokec12 this\cf9 \strokec9 .innerFactory.BeginClose(timeout, callback, state);\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	71.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\}\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	72.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	73.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 protected\cf9 \strokec9 \'a0\cf12 \strokec12 override\cf9 \strokec9 \'a0\cf12 \strokec12 void\cf9 \strokec9 \'a0OnClose(\cf13 \strokec13 TimeSpan\cf9 \strokec9 \'a0timeout)\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	74.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\{\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	75.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 this\cf9 \strokec9 .innerFactory.Close(timeout);\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	76.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\}\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	77.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	78.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 protected\cf9 \strokec9 \'a0\cf12 \strokec12 override\cf9 \strokec9 \'a0\cf12 \strokec12 void\cf9 \strokec9 \'a0OnEndClose(\cf13 \strokec13 IAsyncResult\cf9 \strokec9 \'a0result)\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	79.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\{\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	80.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 this\cf9 \strokec9 .innerFactory.EndClose(result);\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	81.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\}\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	82.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\}\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	83.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	84.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\cf12 \strokec12 class\cf9 \strokec9 \'a0\cf13 \strokec13 MyChannel\cf9 \strokec9 \'a0:\'a0\cf13 \strokec13 ChannelBase\cf9 \strokec9 ,\'a0\cf13 \strokec13 IRequestChannel\cf9 \strokec9 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	85.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\{\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	86.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf13 \strokec13 IRequestChannel\cf9 \strokec9 \'a0innerChannel;\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	87.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 public\cf9 \strokec9 \'a0MyChannel(\cf13 \strokec13 ChannelManagerBase\cf9 \strokec9 \'a0channelManager,\'a0\cf13 \strokec13 IRequestChannel\cf9 \strokec9 \'a0innerChannel)\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	88.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0:\'a0\cf12 \strokec12 base\cf9 \strokec9 (channelManager)\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	89.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\{\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	90.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 this\cf9 \strokec9 .innerChannel = innerChannel;\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	91.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\}\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	92.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	93.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 protected\cf9 \strokec9 \'a0\cf12 \strokec12 override\cf9 \strokec9 \'a0\cf12 \strokec12 void\cf9 \strokec9 \'a0OnAbort()\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	94.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\{\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	95.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 this\cf9 \strokec9 .innerChannel.Abort();\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	96.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\}\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	97.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	98.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 protected\cf9 \strokec9 \'a0\cf12 \strokec12 override\cf9 \strokec9 \'a0\cf13 \strokec13 IAsyncResult\cf9 \strokec9 \'a0OnBeginClose(\cf13 \strokec13 TimeSpan\cf9 \strokec9 \'a0timeout,\'a0\cf13 \strokec13 AsyncCallback\cf9 \strokec9 \'a0callback,\'a0\cf12 \strokec12 object\cf9 \strokec9 \'a0state)\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	99.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\{\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	100.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 return\cf9 \strokec9 \'a0\cf12 \strokec12 this\cf9 \strokec9 .innerChannel.BeginClose(timeout, callback, state);\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	101.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\}\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	102.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	103.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 protected\cf9 \strokec9 \'a0\cf12 \strokec12 override\cf9 \strokec9 \'a0\cf13 \strokec13 IAsyncResult\cf9 \strokec9 \'a0OnBeginOpen(\cf13 \strokec13 TimeSpan\cf9 \strokec9 \'a0timeout,\'a0\cf13 \strokec13 AsyncCallback\cf9 \strokec9 \'a0callback,\'a0\cf12 \strokec12 object\cf9 \strokec9 \'a0state)\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	104.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\{\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	105.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 return\cf9 \strokec9 \'a0\cf12 \strokec12 this\cf9 \strokec9 .innerChannel.BeginOpen(timeout, callback, state);\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	106.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\}\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	107.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	108.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 protected\cf9 \strokec9 \'a0\cf12 \strokec12 override\cf9 \strokec9 \'a0\cf12 \strokec12 void\cf9 \strokec9 \'a0OnClose(\cf13 \strokec13 TimeSpan\cf9 \strokec9 \'a0timeout)\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	109.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\{\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	110.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 this\cf9 \strokec9 .innerChannel.Close(timeout);\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	111.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\}\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	112.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	113.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 protected\cf9 \strokec9 \'a0\cf12 \strokec12 override\cf9 \strokec9 \'a0\cf12 \strokec12 void\cf9 \strokec9 \'a0OnEndClose(\cf13 \strokec13 IAsyncResult\cf9 \strokec9 \'a0result)\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	114.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\{\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	115.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 this\cf9 \strokec9 .innerChannel.EndClose(result);\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	116.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\}\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	117.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	118.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 protected\cf9 \strokec9 \'a0\cf12 \strokec12 override\cf9 \strokec9 \'a0\cf12 \strokec12 void\cf9 \strokec9 \'a0OnEndOpen(\cf13 \strokec13 IAsyncResult\cf9 \strokec9 \'a0result)\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	119.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\{\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	120.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 this\cf9 \strokec9 .innerChannel.EndOpen(result);\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	121.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\}\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	122.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	123.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 protected\cf9 \strokec9 \'a0\cf12 \strokec12 override\cf9 \strokec9 \'a0\cf12 \strokec12 void\cf9 \strokec9 \'a0OnOpen(\cf13 \strokec13 TimeSpan\cf9 \strokec9 \'a0timeout)\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	124.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\{\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	125.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 this\cf9 \strokec9 .innerChannel.Open(timeout);\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	126.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\}\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	127.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	128.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 public\cf9 \strokec9 \'a0\cf13 \strokec13 IAsyncResult\cf9 \strokec9 \'a0BeginRequest(\cf13 \strokec13 Message\cf9 \strokec9 \'a0message,\'a0\cf13 \strokec13 TimeSpan\cf9 \strokec9 \'a0timeout,\'a0\cf13 \strokec13 AsyncCallback\cf9 \strokec9 \'a0callback,\'a0\cf12 \strokec12 object\cf9 \strokec9 \'a0state)\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	129.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\{\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	130.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 return\cf9 \strokec9 \'a0\cf12 \strokec12 this\cf9 \strokec9 .innerChannel.BeginRequest(message, timeout, callback, state);\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	131.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\}\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	132.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	133.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 public\cf9 \strokec9 \'a0\cf13 \strokec13 IAsyncResult\cf9 \strokec9 \'a0BeginRequest(\cf13 \strokec13 Message\cf9 \strokec9 \'a0message,\'a0\cf13 \strokec13 AsyncCallback\cf9 \strokec9 \'a0callback,\'a0\cf12 \strokec12 object\cf9 \strokec9 \'a0state)\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	134.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\{\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	135.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 return\cf9 \strokec9 \'a0\cf12 \strokec12 this\cf9 \strokec9 .innerChannel.BeginRequest(message, callback, state);\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	136.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\}\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	137.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	138.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 public\cf9 \strokec9 \'a0\cf13 \strokec13 Message\cf9 \strokec9 \'a0EndRequest(\cf13 \strokec13 IAsyncResult\cf9 \strokec9 \'a0result)\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	139.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\{\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	140.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 return\cf9 \strokec9 \'a0\cf12 \strokec12 this\cf9 \strokec9 .innerChannel.EndRequest(result);\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	141.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\}\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	142.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	143.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 public\cf9 \strokec9 \'a0\cf13 \strokec13 EndpointAddress\cf9 \strokec9 \'a0RemoteAddress\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	144.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\{\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	145.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 get\cf9 \strokec9 \'a0\{\'a0\cf12 \strokec12 return\cf9 \strokec9 \'a0\cf12 \strokec12 this\cf9 \strokec9 .innerChannel.RemoteAddress; \}\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	146.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\}\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	147.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	148.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 public\cf9 \strokec9 \'a0\cf13 \strokec13 Message\cf9 \strokec9 \'a0Request(\cf13 \strokec13 Message\cf9 \strokec9 \'a0message,\'a0\cf13 \strokec13 TimeSpan\cf9 \strokec9 \'a0timeout)\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	149.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\{\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	150.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 return\cf9 \strokec9 \'a0\cf12 \strokec12 this\cf9 \strokec9 .innerChannel.Request(message, timeout);\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	151.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\}\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	152.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	153.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 public\cf9 \strokec9 \'a0\cf13 \strokec13 Message\cf9 \strokec9 \'a0Request(\cf13 \strokec13 Message\cf9 \strokec9 \'a0message)\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	154.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\{\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	155.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 return\cf9 \strokec9 \'a0\cf12 \strokec12 this\cf9 \strokec9 .innerChannel.Request(message);\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	156.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\}\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	157.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	158.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 public\cf9 \strokec9 \'a0\cf13 \strokec13 Uri\cf9 \strokec9 \'a0Via\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	159.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\{\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	160.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 get\cf9 \strokec9 \'a0\{\'a0\cf12 \strokec12 return\cf9 \strokec9 \'a0\cf12 \strokec12 this\cf9 \strokec9 .innerChannel.Via; \}\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	161.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\}\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	162.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\}\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls3\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	163.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \}\cb1 \
\pard\pardeftab720\sl300\sa200\partightenfactor0
\cf9 \
\pard\pardeftab720\sl340\sa200\partightenfactor0

\f1\fs28 \cf2 \strokec2 \
\pard\pardeftab720\sl340\sa200\partightenfactor0
\cf2 \cb3 As I mentioned before, that\'92s a lot of code for a channel which does absolutely nothing\'85\cb1 \
\pard\pardeftab720\sl520\sa200\partightenfactor0

\fs48 \cf2 \cb3 Real world scenario: a Chaos Monkey channel\cb1 \
\pard\pardeftab720\sl340\sa200\partightenfactor0

\fs28 \cf2 \cb3 One very interesting blog post I\'92ve seen lately was the Netflix team describing their\'a0{\field{\*\fldinst{HYPERLINK "http://techblog.netflix.com/2010/12/5-lessons-weve-learned-using-aws.html"}}{\fldrslt \cf7 \strokec7 experience using Amazon Web Services}}\'a0for their product, and\'a0{\field{\*\fldinst{HYPERLINK "http://www.codinghorror.com/blog/2011/04/working-with-the-chaos-monkey.html"}}{\fldrslt \cf7 \strokec7 Jeff Atwood\'92s post about it}}\'a0in the aftermath of the big outage suffered by AWS. One of the techniques used by Netflix to ensure a good response is what they called the \'93Chaos Monkey\'94, whose job is to randomly kill instances and services in their architecture, to ensure that the other parts which depended on them were resilient to errors and normal downtime of the network systems. With that chaos resiliency, Netflix didn\'92t suffer nearly as much as other companies when AWS stopped working for extended periods of time.\cb1 \
\cb3 If we are building an application which talks to services, and we want to emulate that technique, we can also periodically disconnect / shut down the services and add guards in our application to deal with those situations. But in many cases we don\'92t really own the services we\'92re talking to, so we can\'92t do exactly that. Enter the \'93chaos monkey channel\'94, one implementation of a WCF channel which occasionally throws wrenches in the code by returning a custom messages (normally a fault for SOAP-based services). In this implementation I\'92m using a \'93chaos controller\'94 which lets the user define via an interface how much \'93chaos\'94 they want to introduce into the system.\cb1 \
\cb3 And before I go further, the usual disclaimer: this is a sample for illustrating the topic of this post, this is not production-ready code. I tested it for a few contracts and it worked, but I cannot guarantee that it will work for all scenarios - it does not work for TCP (duplex) or one way (IInput / IOutput) channels. Please let me know if you find a bug or something missing. A more complete implementation would also include support for more channel types, and possibly provide some helper methods for the user to create known faults (i.e., from the fault contract of the operation) instead of leaving it completely up to the user.\cb1 \
\cb3 To start off, the interface which allows the user to add \'93chaos\'94 to the system. I tried to keep it simple, but it could be made more user-friendly so that the user wouldn\'92t need to deal with Message objects directly, but I opted for simplicity on the channel itself.\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls4\ilvl0
\f5\fs26\fsmilli13333 \cf12 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	1.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec12 public\cf9 \strokec9 \'a0\cf12 \strokec12 interface\cf9 \strokec9 \'a0\cf13 \strokec13 IChaosController\cf9 \cb1 \strokec9 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls4\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	2.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \{\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls4\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	3.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\cf12 \strokec12 bool\cf9 \strokec9 \'a0ShouldFault(\cf12 \strokec12 ref\cf9 \strokec9 \'a0\cf13 \strokec13 Message\cf9 \strokec9 \'a0request,\'a0\cf12 \strokec12 out\cf9 \strokec9 \'a0\cf13 \strokec13 Message\cf9 \strokec9 \'a0fault);\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls4\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	4.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \}\
\pard\pardeftab720\sl300\sa200\partightenfactor0
\cf9 \cb1 \
\pard\pardeftab720\sl340\sa200\partightenfactor0

\f1\fs28 \cf2 \strokec2 \
\pard\pardeftab720\sl340\sa200\partightenfactor0
\cf2 \cb3 Next I had to decide which channel shape to use. Since HTTP is the most common protocol used in communication, I started with an IRequestChannel implementation, which worked fine for a custom binding based on the BasicHttpBinding. Here\'92s the binding element which can be added.\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls5\ilvl0
\f5\fs26\fsmilli13333 \cf12 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	1.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec12 public\cf9 \strokec9 \'a0\cf12 \strokec12 class\cf9 \strokec9 \'a0\cf13 \strokec13 ChaosMonkeyBindingElement\cf9 \strokec9 \'a0:\'a0\cf13 \strokec13 BindingElement\cf9 \cb1 \strokec9 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls5\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	2.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \{\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls5\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	3.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\cf13 \strokec13 IChaosController\cf9 \strokec9 \'a0controller;\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls5\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	4.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\cf12 \strokec12 public\cf9 \strokec9 \'a0ChaosMonkeyBindingElement(\cf13 \strokec13 IChaosController\cf9 \strokec9 \'a0controller)\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls5\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	5.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\{\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls5\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	6.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 if\cf9 \strokec9 \'a0(controller ==\'a0\cf12 \strokec12 null\cf9 \strokec9 )\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls5\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	7.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\{\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls5\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	8.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 throw\cf9 \strokec9 \'a0\cf12 \strokec12 new\cf9 \strokec9 \'a0\cf13 \strokec13 ArgumentNullException\cf9 \strokec9 (\cf15 \strokec15 "controller"\cf9 \strokec9 );\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls5\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	9.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\}\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls5\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	10.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls5\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	11.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 this\cf9 \strokec9 .controller = controller;\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls5\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	12.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\}\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls5\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	13.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls5\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	14.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\cf12 \strokec12 public\cf9 \strokec9 \'a0\cf12 \strokec12 override\cf9 \strokec9 \'a0\cf12 \strokec12 bool\cf9 \strokec9 \'a0CanBuildChannelFactory<TChannel>(\cf13 \strokec13 BindingContext\cf9 \strokec9 \'a0context)\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls5\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	15.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\{\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls5\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	16.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 if\cf9 \strokec9 \'a0(context ==\'a0\cf12 \strokec12 null\cf9 \strokec9 )\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls5\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	17.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\{\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls5\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	18.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 throw\cf9 \strokec9 \'a0\cf12 \strokec12 new\cf9 \strokec9 \'a0\cf13 \strokec13 ArgumentNullException\cf9 \strokec9 (\cf15 \strokec15 "context"\cf9 \strokec9 );\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls5\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	19.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\}\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls5\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	20.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls5\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	21.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 if\cf9 \strokec9 \'a0(\cf12 \strokec12 typeof\cf9 \strokec9 (TChannel) ==\'a0\cf12 \strokec12 typeof\cf9 \strokec9 (\cf13 \strokec13 IRequestChannel\cf9 \strokec9 ))\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls5\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	22.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\{\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls5\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	23.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 bool\cf9 \strokec9 \'a0innerCanBuild = context.CanBuildInnerChannelFactory<TChannel>();\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls5\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	24.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 return\cf9 \strokec9 \'a0innerCanBuild;\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls5\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	25.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\}\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls5\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	26.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls5\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	27.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 return\cf9 \strokec9 \'a0\cf12 \strokec12 false\cf9 \strokec9 ;\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls5\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	28.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\}\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls5\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	29.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls5\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	30.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\cf12 \strokec12 public\cf9 \strokec9 \'a0\cf12 \strokec12 override\cf9 \strokec9 \'a0\cf13 \strokec13 IChannelFactory\cf9 \strokec9 <TChannel> BuildChannelFactory<TChannel>(\cf13 \strokec13 BindingContext\cf9 \strokec9 \'a0context)\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls5\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	31.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\{\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls5\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	32.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 if\cf9 \strokec9 \'a0(context ==\'a0\cf12 \strokec12 null\cf9 \strokec9 )\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls5\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	33.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\{\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls5\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	34.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 throw\cf9 \strokec9 \'a0\cf12 \strokec12 new\cf9 \strokec9 \'a0\cf13 \strokec13 ArgumentNullException\cf9 \strokec9 (\cf15 \strokec15 "context"\cf9 \strokec9 );\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls5\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	35.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\}\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls5\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	36.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls5\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	37.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 if\cf9 \strokec9 \'a0(\cf12 \strokec12 typeof\cf9 \strokec9 (TChannel) !=\'a0\cf12 \strokec12 typeof\cf9 \strokec9 (\cf13 \strokec13 IRequestChannel\cf9 \strokec9 ))\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls5\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	38.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\{\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls5\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	39.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 throw\cf9 \strokec9 \'a0\cf12 \strokec12 new\cf9 \strokec9 \'a0\cf13 \strokec13 InvalidOperationException\cf9 \strokec9 (\cf15 \strokec15 "Only IRequestChannel is supported"\cf9 \strokec9 );\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls5\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	40.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\}\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls5\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	41.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls5\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	42.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 var\cf9 \strokec9 \'a0factory =\'a0\cf12 \strokec12 new\cf9 \strokec9 \'a0\cf13 \strokec13 ChaosMonkeyRequestChannelFactory\cf9 \strokec9 (context.BuildInnerChannelFactory<\cf13 \strokec13 IRequestChannel\cf9 \strokec9 >(),\'a0\cf12 \strokec12 this\cf9 \strokec9 .controller);\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls5\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	43.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 return\cf9 \strokec9 \'a0(\cf13 \strokec13 IChannelFactory\cf9 \strokec9 <TChannel>)factory;\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls5\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	44.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\}\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls5\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	45.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls5\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	46.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\cf12 \strokec12 public\cf9 \strokec9 \'a0\cf12 \strokec12 override\cf9 \strokec9 \'a0\cf13 \strokec13 BindingElement\cf9 \strokec9 \'a0Clone()\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls5\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	47.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\{\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls5\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	48.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 return\cf9 \strokec9 \'a0\cf12 \strokec12 new\cf9 \strokec9 \'a0\cf13 \strokec13 ChaosMonkeyBindingElement\cf9 \strokec9 (\cf12 \strokec12 this\cf9 \strokec9 .controller);\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls5\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	49.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\}\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls5\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	50.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls5\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	51.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\cf12 \strokec12 public\cf9 \strokec9 \'a0\cf12 \strokec12 override\cf9 \strokec9 \'a0T GetProperty<T>(\cf13 \strokec13 BindingContext\cf9 \strokec9 \'a0context)\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls5\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	52.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\{\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls5\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	53.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 return\cf9 \strokec9 \'a0context.GetInnerProperty<T>();\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls5\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	54.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\}\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls5\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	55.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \}\cb1 \
\pard\pardeftab720\sl300\sa200\partightenfactor0
\cf9 \
\pard\pardeftab720\sl340\sa200\partightenfactor0

\f1\fs28 \cf2 \strokec2 \
\pard\pardeftab720\sl340\sa200\partightenfactor0
\cf2 \cb3 On to the channel factory. Implementing it for this scenario was fairly simple, just with a bunch of boilerplate methods which delegated the call to the factory of the next element in the binding element stack.\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls6\ilvl0
\f5\fs26\fsmilli13333 \cf12 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	1.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec12 class\cf9 \strokec9 \'a0\cf13 \strokec13 ChaosMonkeyRequestChannelFactory\cf9 \strokec9 \'a0:\'a0\cf13 \strokec13 ChannelFactoryBase\cf9 \strokec9 <\cf13 \strokec13 IRequestChannel\cf9 \strokec9 >\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls6\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	2.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \{\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls6\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	3.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\cf13 \strokec13 IChannelFactory\cf9 \strokec9 <\cf13 \strokec13 IRequestChannel\cf9 \strokec9 > innerFactory;\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls6\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	4.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\cf13 \strokec13 IChaosController\cf9 \strokec9 \'a0controller;\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls6\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	5.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls6\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	6.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\cf12 \strokec12 public\cf9 \strokec9 \'a0ChaosMonkeyRequestChannelFactory(\cf13 \strokec13 IChannelFactory\cf9 \strokec9 <\cf13 \strokec13 IRequestChannel\cf9 \strokec9 > innerFactory,\'a0\cf13 \strokec13 IChaosController\cf9 \strokec9 \'a0controller)\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls6\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	7.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\{\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls6\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	8.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 this\cf9 \strokec9 .innerFactory = innerFactory;\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls6\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	9.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 this\cf9 \strokec9 .controller = controller;\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls6\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	10.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\}\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls6\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	11.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls6\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	12.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\cf12 \strokec12 protected\cf9 \strokec9 \'a0\cf12 \strokec12 override\cf9 \strokec9 \'a0\cf13 \strokec13 IRequestChannel\cf9 \strokec9 \'a0OnCreateChannel(\cf13 \strokec13 EndpointAddress\cf9 \strokec9 \'a0address,\'a0\cf13 \strokec13 Uri\cf9 \strokec9 \'a0via)\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls6\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	13.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\{\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls6\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	14.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 return\cf9 \strokec9 \'a0\cf12 \strokec12 new\cf9 \strokec9 \'a0\cf13 \strokec13 ChaosMonkeyRequestChannel\cf9 \strokec9 (\cf12 \strokec12 this\cf9 \strokec9 ,\'a0\cf12 \strokec12 this\cf9 \strokec9 .innerFactory.CreateChannel(address, via),\'a0\cf12 \strokec12 this\cf9 \strokec9 .controller);\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls6\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	15.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\}\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls6\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	16.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls6\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	17.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\cf12 \strokec12 #region\cf9 \strokec9 \'a0Boilerplate methods which simply delegate to the inner factory\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls6\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	18.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\cf12 \strokec12 public\cf9 \strokec9 \'a0\cf12 \strokec12 override\cf9 \strokec9 \'a0T GetProperty<T>()\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls6\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	19.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\{\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls6\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	20.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 return\cf9 \strokec9 \'a0\cf12 \strokec12 this\cf9 \strokec9 .innerFactory.GetProperty<T>();\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls6\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	21.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\}\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls6\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	22.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls6\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	23.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\cf12 \strokec12 protected\cf9 \strokec9 \'a0\cf12 \strokec12 override\cf9 \strokec9 \'a0\cf13 \strokec13 IAsyncResult\cf9 \strokec9 \'a0OnBeginOpen(\cf13 \strokec13 TimeSpan\cf9 \strokec9 \'a0timeout,\'a0\cf13 \strokec13 AsyncCallback\cf9 \strokec9 \'a0callback,\'a0\cf12 \strokec12 object\cf9 \strokec9 \'a0state)\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls6\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	24.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\{\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls6\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	25.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 return\cf9 \strokec9 \'a0\cf12 \strokec12 this\cf9 \strokec9 .innerFactory.BeginOpen(timeout, callback, state);\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls6\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	26.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\}\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls6\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	27.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls6\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	28.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\cf12 \strokec12 protected\cf9 \strokec9 \'a0\cf12 \strokec12 override\cf9 \strokec9 \'a0\cf12 \strokec12 void\cf9 \strokec9 \'a0OnEndOpen(\cf13 \strokec13 IAsyncResult\cf9 \strokec9 \'a0result)\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls6\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	29.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\{\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls6\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	30.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 this\cf9 \strokec9 .innerFactory.EndOpen(result);\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls6\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	31.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\}\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls6\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	32.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls6\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	33.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\cf12 \strokec12 protected\cf9 \strokec9 \'a0\cf12 \strokec12 override\cf9 \strokec9 \'a0\cf12 \strokec12 void\cf9 \strokec9 \'a0OnOpen(\cf13 \strokec13 TimeSpan\cf9 \strokec9 \'a0timeout)\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls6\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	34.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\{\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls6\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	35.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 this\cf9 \strokec9 .innerFactory.Open();\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls6\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	36.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\}\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls6\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	37.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls6\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	38.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\cf12 \strokec12 protected\cf9 \strokec9 \'a0\cf12 \strokec12 override\cf9 \strokec9 \'a0\cf12 \strokec12 void\cf9 \strokec9 \'a0OnAbort()\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls6\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	39.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\{\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls6\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	40.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 this\cf9 \strokec9 .innerFactory.Abort();\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls6\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	41.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\}\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls6\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	42.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls6\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	43.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\cf12 \strokec12 protected\cf9 \strokec9 \'a0\cf12 \strokec12 override\cf9 \strokec9 \'a0\cf13 \strokec13 IAsyncResult\cf9 \strokec9 \'a0OnBeginClose(\cf13 \strokec13 TimeSpan\cf9 \strokec9 \'a0timeout,\'a0\cf13 \strokec13 AsyncCallback\cf9 \strokec9 \'a0callback,\'a0\cf12 \strokec12 object\cf9 \strokec9 \'a0state)\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls6\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	44.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\{\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls6\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	45.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 return\cf9 \strokec9 \'a0\cf12 \strokec12 this\cf9 \strokec9 .innerFactory.BeginClose(timeout, callback, state);\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls6\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	46.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\}\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls6\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	47.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls6\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	48.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\cf12 \strokec12 protected\cf9 \strokec9 \'a0\cf12 \strokec12 override\cf9 \strokec9 \'a0\cf12 \strokec12 void\cf9 \strokec9 \'a0OnClose(\cf13 \strokec13 TimeSpan\cf9 \strokec9 \'a0timeout)\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls6\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	49.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\{\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls6\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	50.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 this\cf9 \strokec9 .innerFactory.Close(timeout);\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls6\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	51.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\}\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls6\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	52.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls6\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	53.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\cf12 \strokec12 protected\cf9 \strokec9 \'a0\cf12 \strokec12 override\cf9 \strokec9 \'a0\cf12 \strokec12 void\cf9 \strokec9 \'a0OnEndClose(\cf13 \strokec13 IAsyncResult\cf9 \strokec9 \'a0result)\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls6\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	54.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\{\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls6\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	55.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 this\cf9 \strokec9 .innerFactory.EndClose(result);\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls6\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	56.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\}\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls6\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	57.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\cf12 \strokec12 #endregion\cf9 \cb1 \strokec9 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls6\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	58.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \}\
\pard\pardeftab720\sl300\sa200\partightenfactor0
\cf9 \cb1 \
\pard\pardeftab720\sl340\sa200\partightenfactor0

\f1\fs28 \cf2 \strokec2 \
\pard\pardeftab720\sl340\sa200\partightenfactor0
\cf2 \cb3 Finally the channel itself. To keep the channel simple, I removed the code which dealt with messages and moved it into a separate (private) helper class, so the implementation of the request channel itself would be kept simple.\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls7\ilvl0
\f5\fs26\fsmilli13333 \cf12 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	1.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec12 class\cf9 \strokec9 \'a0\cf13 \strokec13 ChaosMonkeyRequestChannel\cf9 \strokec9 \'a0:\'a0\cf13 \strokec13 ChannelBase\cf9 \strokec9 ,\'a0\cf13 \strokec13 IRequestChannel\cf9 \cb1 \strokec9 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls7\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	2.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \{\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls7\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	3.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\cf13 \strokec13 IRequestChannel\cf9 \strokec9 \'a0innerChannel;\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls7\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	4.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\cf13 \strokec13 IChaosController\cf9 \strokec9 \'a0controller;\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls7\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	5.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\cf13 \strokec13 RequestChannelHelper\cf9 \strokec9 \'a0helper;\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls7\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	6.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls7\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	7.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\cf12 \strokec12 public\cf9 \strokec9 \'a0ChaosMonkeyRequestChannel(\cf13 \strokec13 ChannelManagerBase\cf9 \strokec9 \'a0channelManager,\'a0\cf13 \strokec13 IRequestChannel\cf9 \strokec9 \'a0innerChannel,\'a0\cf13 \strokec13 IChaosController\cf9 \strokec9 \'a0controller)\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls7\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	8.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0:\'a0\cf12 \strokec12 base\cf9 \strokec9 (channelManager)\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls7\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	9.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\{\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls7\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	10.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 this\cf9 \strokec9 .innerChannel = innerChannel;\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls7\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	11.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 this\cf9 \strokec9 .controller = controller;\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls7\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	12.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 this\cf9 \strokec9 .helper =\'a0\cf12 \strokec12 new\cf9 \strokec9 \'a0\cf13 \strokec13 RequestChannelHelper\cf9 \strokec9 (innerChannel, controller);\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls7\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	13.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\}\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls7\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	14.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls7\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	15.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\cf12 \strokec12 public\cf9 \strokec9 \'a0\cf13 \strokec13 IAsyncResult\cf9 \strokec9 \'a0BeginRequest(\cf13 \strokec13 Message\cf9 \strokec9 \'a0message,\'a0\cf13 \strokec13 TimeSpan\cf9 \strokec9 \'a0timeout,\'a0\cf13 \strokec13 AsyncCallback\cf9 \strokec9 \'a0callback,\'a0\cf12 \strokec12 object\cf9 \strokec9 \'a0state)\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls7\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	16.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\{\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls7\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	17.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 return\cf9 \strokec9 \'a0\cf12 \strokec12 this\cf9 \strokec9 .helper.BeginRequest(message, timeout, callback, state);\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls7\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	18.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\}\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls7\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	19.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls7\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	20.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\cf12 \strokec12 public\cf9 \strokec9 \'a0\cf13 \strokec13 IAsyncResult\cf9 \strokec9 \'a0BeginRequest(\cf13 \strokec13 Message\cf9 \strokec9 \'a0message,\'a0\cf13 \strokec13 AsyncCallback\cf9 \strokec9 \'a0callback,\'a0\cf12 \strokec12 object\cf9 \strokec9 \'a0state)\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls7\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	21.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\{\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls7\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	22.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 return\cf9 \strokec9 \'a0\cf12 \strokec12 this\cf9 \strokec9 .BeginRequest(message,\'a0\cf12 \strokec12 this\cf9 \strokec9 .DefaultSendTimeout, callback, state);\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls7\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	23.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\}\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls7\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	24.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls7\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	25.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\cf12 \strokec12 public\cf9 \strokec9 \'a0\cf13 \strokec13 Message\cf9 \strokec9 \'a0EndRequest(\cf13 \strokec13 IAsyncResult\cf9 \strokec9 \'a0result)\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls7\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	26.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\{\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls7\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	27.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 return\cf9 \strokec9 \'a0\cf12 \strokec12 this\cf9 \strokec9 .helper.EndRequest(result);\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls7\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	28.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\}\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls7\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	29.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls7\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	30.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\cf12 \strokec12 public\cf9 \strokec9 \'a0\cf13 \strokec13 Message\cf9 \strokec9 \'a0Request(\cf13 \strokec13 Message\cf9 \strokec9 \'a0message,\'a0\cf13 \strokec13 TimeSpan\cf9 \strokec9 \'a0timeout)\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls7\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	31.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\{\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls7\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	32.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 return\cf9 \strokec9 \'a0\cf12 \strokec12 this\cf9 \strokec9 .helper.Request(message, timeout);\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls7\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	33.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\}\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls7\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	34.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls7\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	35.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\cf12 \strokec12 public\cf9 \strokec9 \'a0\cf13 \strokec13 Message\cf9 \strokec9 \'a0Request(\cf13 \strokec13 Message\cf9 \strokec9 \'a0message)\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls7\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	36.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\{\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls7\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	37.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 return\cf9 \strokec9 \'a0\cf12 \strokec12 this\cf9 \strokec9 .Request(message,\'a0\cf12 \strokec12 this\cf9 \strokec9 .DefaultSendTimeout);\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls7\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	38.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\}\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls7\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	39.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls7\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	40.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\cf12 \strokec12 #region\cf9 \strokec9 \'a0Boilerplate methods which simply delegate to the inner channel\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls7\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	41.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\cf12 \strokec12 protected\cf9 \strokec9 \'a0\cf12 \strokec12 override\cf9 \strokec9 \'a0\cf12 \strokec12 void\cf9 \strokec9 \'a0OnAbort()\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls7\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	42.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\{\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls7\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	43.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 this\cf9 \strokec9 .innerChannel.Abort();\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls7\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	44.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\}\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls7\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	45.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls7\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	46.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\cf12 \strokec12 protected\cf9 \strokec9 \'a0\cf12 \strokec12 override\cf9 \strokec9 \'a0\cf13 \strokec13 IAsyncResult\cf9 \strokec9 \'a0OnBeginClose(\cf13 \strokec13 TimeSpan\cf9 \strokec9 \'a0timeout,\'a0\cf13 \strokec13 AsyncCallback\cf9 \strokec9 \'a0callback,\'a0\cf12 \strokec12 object\cf9 \strokec9 \'a0state)\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls7\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	47.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\{\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls7\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	48.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 return\cf9 \strokec9 \'a0\cf12 \strokec12 this\cf9 \strokec9 .innerChannel.BeginClose(timeout, callback, state);\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls7\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	49.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\}\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls7\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	50.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls7\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	51.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\cf12 \strokec12 protected\cf9 \strokec9 \'a0\cf12 \strokec12 override\cf9 \strokec9 \'a0\cf13 \strokec13 IAsyncResult\cf9 \strokec9 \'a0OnBeginOpen(\cf13 \strokec13 TimeSpan\cf9 \strokec9 \'a0timeout,\'a0\cf13 \strokec13 AsyncCallback\cf9 \strokec9 \'a0callback,\'a0\cf12 \strokec12 object\cf9 \strokec9 \'a0state)\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls7\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	52.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\{\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls7\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	53.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 return\cf9 \strokec9 \'a0\cf12 \strokec12 this\cf9 \strokec9 .innerChannel.BeginOpen(timeout, callback, state);\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls7\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	54.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\}\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls7\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	55.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls7\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	56.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\cf12 \strokec12 protected\cf9 \strokec9 \'a0\cf12 \strokec12 override\cf9 \strokec9 \'a0\cf12 \strokec12 void\cf9 \strokec9 \'a0OnClose(\cf13 \strokec13 TimeSpan\cf9 \strokec9 \'a0timeout)\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls7\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	57.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\{\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls7\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	58.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 this\cf9 \strokec9 .innerChannel.Close(timeout);\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls7\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	59.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\}\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls7\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	60.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls7\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	61.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\cf12 \strokec12 protected\cf9 \strokec9 \'a0\cf12 \strokec12 override\cf9 \strokec9 \'a0\cf12 \strokec12 void\cf9 \strokec9 \'a0OnEndClose(\cf13 \strokec13 IAsyncResult\cf9 \strokec9 \'a0result)\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls7\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	62.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\{\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls7\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	63.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 this\cf9 \strokec9 .innerChannel.EndClose(result);\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls7\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	64.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\}\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls7\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	65.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls7\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	66.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\cf12 \strokec12 protected\cf9 \strokec9 \'a0\cf12 \strokec12 override\cf9 \strokec9 \'a0\cf12 \strokec12 void\cf9 \strokec9 \'a0OnEndOpen(\cf13 \strokec13 IAsyncResult\cf9 \strokec9 \'a0result)\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls7\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	67.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\{\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls7\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	68.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 this\cf9 \strokec9 .innerChannel.EndOpen(result);\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls7\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	69.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\}\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls7\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	70.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls7\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	71.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\cf12 \strokec12 protected\cf9 \strokec9 \'a0\cf12 \strokec12 override\cf9 \strokec9 \'a0\cf12 \strokec12 void\cf9 \strokec9 \'a0OnOpen(\cf13 \strokec13 TimeSpan\cf9 \strokec9 \'a0timeout)\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls7\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	72.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\{\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls7\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	73.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 this\cf9 \strokec9 .innerChannel.Open(timeout);\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls7\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	74.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\}\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls7\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	75.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls7\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	76.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\cf12 \strokec12 public\cf9 \strokec9 \'a0\cf12 \strokec12 override\cf9 \strokec9 \'a0T GetProperty<T>()\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls7\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	77.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\{\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls7\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	78.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 return\cf9 \strokec9 \'a0\cf12 \strokec12 this\cf9 \strokec9 .innerChannel.GetProperty<T>();\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls7\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	79.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\}\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls7\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	80.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls7\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	81.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\cf12 \strokec12 public\cf9 \strokec9 \'a0\cf13 \strokec13 EndpointAddress\cf9 \strokec9 \'a0RemoteAddress\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls7\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	82.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\{\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls7\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	83.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 get\cf9 \strokec9 \'a0\{\'a0\cf12 \strokec12 return\cf9 \strokec9 \'a0\cf12 \strokec12 this\cf9 \strokec9 .innerChannel.RemoteAddress; \}\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls7\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	84.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\}\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls7\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	85.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls7\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	86.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\cf12 \strokec12 public\cf9 \strokec9 \'a0\cf13 \strokec13 Uri\cf9 \strokec9 \'a0Via\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls7\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	87.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\{\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls7\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	88.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 get\cf9 \strokec9 \'a0\{\'a0\cf12 \strokec12 return\cf9 \strokec9 \'a0\cf12 \strokec12 this\cf9 \strokec9 .innerChannel.Via; \}\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls7\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	89.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\}\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls7\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	90.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\cf12 \strokec12 #endregion\cf9 \strokec9 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls7\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	91.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \}\cb1 \
\pard\pardeftab720\sl300\sa200\partightenfactor0
\cf9 \
\pard\pardeftab720\sl340\sa200\partightenfactor0

\f1\fs28 \cf2 \strokec2 \
\pard\pardeftab720\sl340\sa200\partightenfactor0
\cf2 \cb3 The synchronous path of the helper class is fairly straightforward: if the controller says that we should return a fault, we just return the message returned by the chaos controller, and the rest of the stack is bypassed (the request won\'92t be sent to the server). On the asynchronous case, we need to return an\'a0{\field{\*\fldinst{HYPERLINK "http://msdn.microsoft.com/en-us/library/system.iasyncresult.aspx"}}{\fldrslt \cf7 \strokec7 IAsyncResult}}\'a0to the caller, and depending on whether the chaos should happen or not, this asynchronous result will come from different sources. Here I used the same pattern as I described in the post about\'a0{\field{\*\fldinst{HYPERLINK "http://blogs.msdn.com/b/carlosfigueira/archive/2011/05/17/wcf-extensibility-ioperationinvoker.aspx"}}{\fldrslt \cf7 \strokec7 operation invokers}}, in which the response is wrapped in a custom\'a0{\field{\*\fldinst{HYPERLINK "http://msdn.microsoft.com/en-us/library/system.iasyncresult.aspx"}}{\fldrslt \cf7 \strokec7 IAsyncResult}}\'a0implementation (I\'92ll omit the class CorrelatingAsyncResult in this post, it can be seen in the code for this post link at the bottom).\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls8\ilvl0
\f5\fs26\fsmilli13333 \cf12 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	1.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec12 class\cf9 \strokec9 \'a0\cf13 \strokec13 RequestChannelHelper\cf9 \cb1 \strokec9 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls8\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	2.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \{\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls8\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	3.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\cf13 \strokec13 IRequestChannel\cf9 \strokec9 \'a0innerChannel;\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls8\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	4.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\cf13 \strokec13 IChaosController\cf9 \strokec9 \'a0controller;\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls8\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	5.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls8\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	6.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\cf12 \strokec12 public\cf9 \strokec9 \'a0RequestChannelHelper(\cf13 \strokec13 IRequestChannel\cf9 \strokec9 \'a0innerChannel,\'a0\cf13 \strokec13 IChaosController\cf9 \strokec9 \'a0controller)\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls8\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	7.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\{\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls8\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	8.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 this\cf9 \strokec9 .innerChannel = innerChannel;\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls8\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	9.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 this\cf9 \strokec9 .controller = controller;\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls8\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	10.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\}\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls8\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	11.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls8\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	12.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\cf12 \strokec12 public\cf9 \strokec9 \'a0\cf13 \strokec13 IAsyncResult\cf9 \strokec9 \'a0BeginRequest(\cf13 \strokec13 Message\cf9 \strokec9 \'a0message,\'a0\cf13 \strokec13 TimeSpan\cf9 \strokec9 \'a0timeout,\'a0\cf13 \strokec13 AsyncCallback\cf9 \strokec9 \'a0callback,\'a0\cf12 \strokec12 object\cf9 \strokec9 \'a0state)\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls8\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	13.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\{\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls8\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	14.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf13 \strokec13 Message\cf9 \strokec9 \'a0result;\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls8\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	15.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 if\cf9 \strokec9 \'a0(\cf12 \strokec12 this\cf9 \strokec9 .controller.ShouldFault(\cf12 \strokec12 ref\cf9 \strokec9 \'a0message,\'a0\cf12 \strokec12 out\cf9 \strokec9 \'a0result))\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls8\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	16.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\{\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls8\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	17.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf13 \strokec13 Func\cf9 \strokec9 <\cf13 \strokec13 Message\cf9 \strokec9 > getMessage = () => result;\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls8\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	18.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf13 \strokec13 CorrelationState\cf9 \strokec9 \'a0correlationState =\'a0\cf12 \strokec12 new\cf9 \strokec9 \'a0\cf13 \strokec13 CorrelationState\cf9 \strokec9 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls8\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	19.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\{\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls8\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	20.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0OriginalCallback = callback,\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls8\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	21.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0OriginalAsyncState = state,\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls8\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	22.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0FaultMessage = result,\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls8\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	23.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\};\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls8\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	24.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf13 \strokec13 IAsyncResult\cf9 \strokec9 \'a0funcResult = getMessage.BeginInvoke(\cf12 \strokec12 this\cf9 \strokec9 .MonkeyRequestCallback, correlationState);\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls8\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	25.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 return\cf9 \strokec9 \'a0\cf12 \strokec12 new\cf9 \strokec9 \'a0\cf13 \strokec13 CorrelatingAsyncResult\cf9 \strokec9 (funcResult, state, correlationState);\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls8\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	26.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\}\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls8\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	27.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 else\cf9 \cb1 \strokec9 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls8\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	28.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\{\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls8\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	29.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 return\cf9 \strokec9 \'a0\cf12 \strokec12 this\cf9 \strokec9 .innerChannel.BeginRequest(message, timeout, callback, state);\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls8\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	30.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\}\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls8\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	31.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\}\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls8\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	32.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls8\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	33.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\cf12 \strokec12 public\cf9 \strokec9 \'a0\cf13 \strokec13 Message\cf9 \strokec9 \'a0EndRequest(\cf13 \strokec13 IAsyncResult\cf9 \strokec9 \'a0result)\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls8\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	34.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\{\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls8\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	35.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf13 \strokec13 CorrelatingAsyncResult\cf9 \strokec9 \'a0correlatingResult = result\'a0\cf12 \strokec12 as\cf9 \strokec9 \'a0\cf13 \strokec13 CorrelatingAsyncResult\cf9 \strokec9 ;\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls8\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	36.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 if\cf9 \strokec9 \'a0(correlatingResult !=\'a0\cf12 \strokec12 null\cf9 \strokec9 )\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls8\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	37.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\{\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls8\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	38.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 return\cf9 \strokec9 \'a0((\cf13 \strokec13 CorrelationState\cf9 \strokec9 )correlatingResult.CorrelationData).FaultMessage;\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls8\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	39.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\}\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls8\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	40.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 else\cf9 \strokec9 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls8\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	41.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\{\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls8\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	42.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 return\cf9 \strokec9 \'a0\cf12 \strokec12 this\cf9 \strokec9 .innerChannel.EndRequest(result);\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls8\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	43.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\}\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls8\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	44.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\}\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls8\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	45.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls8\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	46.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\cf12 \strokec12 public\cf9 \strokec9 \'a0\cf13 \strokec13 Message\cf9 \strokec9 \'a0Request(\cf13 \strokec13 Message\cf9 \strokec9 \'a0message,\'a0\cf13 \strokec13 TimeSpan\cf9 \strokec9 \'a0timeout)\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls8\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	47.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\{\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls8\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	48.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf13 \strokec13 Message\cf9 \strokec9 \'a0result;\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls8\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	49.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 if\cf9 \strokec9 \'a0(\cf12 \strokec12 this\cf9 \strokec9 .controller.ShouldFault(\cf12 \strokec12 ref\cf9 \strokec9 \'a0message,\'a0\cf12 \strokec12 out\cf9 \strokec9 \'a0result))\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls8\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	50.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\{\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls8\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	51.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 return\cf9 \strokec9 \'a0result;\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls8\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	52.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\}\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls8\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	53.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 else\cf9 \cb1 \strokec9 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls8\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	54.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\{\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls8\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	55.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 return\cf9 \strokec9 \'a0\cf12 \strokec12 this\cf9 \strokec9 .innerChannel.Request(message, timeout);\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls8\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	56.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\}\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls8\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	57.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\}\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls8\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	58.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls8\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	59.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\cf12 \strokec12 private\cf9 \strokec9 \'a0\cf12 \strokec12 void\cf9 \strokec9 \'a0MonkeyRequestCallback(\cf13 \strokec13 IAsyncResult\cf9 \strokec9 \'a0asyncResult)\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls8\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	60.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\{\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls8\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	61.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf13 \strokec13 CorrelationState\cf9 \strokec9 \'a0state = (\cf13 \strokec13 CorrelationState\cf9 \strokec9 )asyncResult.AsyncState;\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls8\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	62.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0(((System.Runtime.Remoting.Messaging.\cf13 \strokec13 AsyncResult\cf9 \strokec9 )asyncResult).AsyncDelegate\'a0\cf12 \strokec12 as\cf9 \strokec9 \'a0\cf13 \strokec13 Func\cf9 \strokec9 <\cf13 \strokec13 Message\cf9 \strokec9 >).EndInvoke(asyncResult);\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls8\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	63.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf13 \strokec13 IAsyncResult\cf9 \strokec9 \'a0newAsyncResult =\'a0\cf12 \strokec12 new\cf9 \strokec9 \'a0\cf13 \strokec13 CorrelatingAsyncResult\cf9 \strokec9 (asyncResult, state.OriginalAsyncState, state);\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls8\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	64.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0state.OriginalCallback(newAsyncResult);\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls8\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	65.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\}\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls8\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	66.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls8\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	67.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\cf12 \strokec12 class\cf9 \strokec9 \'a0\cf13 \strokec13 CorrelationState\cf9 \cb1 \strokec9 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls8\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	68.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\{\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls8\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	69.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 public\cf9 \strokec9 \'a0\cf13 \strokec13 AsyncCallback\cf9 \strokec9 \'a0OriginalCallback \{\'a0\cf12 \strokec12 get\cf9 \strokec9 ;\'a0\cf12 \strokec12 set\cf9 \strokec9 ; \}\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls8\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	70.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 public\cf9 \strokec9 \'a0\cf12 \strokec12 object\cf9 \strokec9 \'a0OriginalAsyncState \{\'a0\cf12 \strokec12 get\cf9 \strokec9 ;\'a0\cf12 \strokec12 set\cf9 \strokec9 ; \}\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls8\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	71.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 public\cf9 \strokec9 \'a0\cf13 \strokec13 Message\cf9 \strokec9 \'a0FaultMessage \{\'a0\cf12 \strokec12 get\cf9 \strokec9 ;\'a0\cf12 \strokec12 set\cf9 \strokec9 ; \}\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls8\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	72.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\}\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls8\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	73.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \}\cb1 \
\pard\pardeftab720\sl300\sa200\partightenfactor0
\cf9 \
\pard\pardeftab720\sl340\sa200\partightenfactor0

\f1\fs28 \cf2 \strokec2 \
\pard\pardeftab720\sl340\sa200\partightenfactor0
\cf2 \cb3 And that\'92s it \'96 we can now test it. For that I\'92ll use a very simple server (a simple Add operation) and controller (which randomly creates problems for 20% of the messages).\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls9\ilvl0
\f5\fs26\fsmilli13333 \cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	1.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 [\cf13 \strokec13 ServiceContract\cf9 \strokec9 ]\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls9\ilvl0\cf12 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	2.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec12 public\cf9 \strokec9 \'a0\cf12 \strokec12 interface\cf9 \strokec9 \'a0\cf13 \strokec13 ITest\cf9 \strokec9 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls9\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	3.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \{\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls9\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	4.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0[\cf13 \strokec13 OperationContract\cf9 \strokec9 ]\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls9\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	5.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\cf12 \strokec12 int\cf9 \strokec9 \'a0Add(\cf12 \strokec12 int\cf9 \strokec9 \'a0x,\'a0\cf12 \strokec12 int\cf9 \strokec9 \'a0y);\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls9\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	6.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \}\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls9\ilvl0\cf12 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	7.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec12 public\cf9 \strokec9 \'a0\cf12 \strokec12 class\cf9 \strokec9 \'a0\cf13 \strokec13 Service\cf9 \strokec9 \'a0:\'a0\cf13 \strokec13 ITest\cf9 \cb1 \strokec9 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls9\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	8.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \{\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls9\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	9.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\cf12 \strokec12 public\cf9 \strokec9 \'a0\cf12 \strokec12 int\cf9 \strokec9 \'a0Add(\cf12 \strokec12 int\cf9 \strokec9 \'a0x,\'a0\cf12 \strokec12 int\cf9 \strokec9 \'a0y)\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls9\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	10.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\{\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls9\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	11.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf13 \strokec13 Console\cf9 \strokec9 .WriteLine(\cf15 \strokec15 "[service] \{0\} + \{1\}"\cf9 \strokec9 , x, y);\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls9\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	12.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 return\cf9 \strokec9 \'a0x + y;\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls9\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	13.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\}\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls9\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	14.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \}\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls9\ilvl0\cf12 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	15.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec12 class\cf9 \strokec9 \'a0\cf13 \strokec13 MyMonkeyController\cf9 \strokec9 \'a0:\'a0\cf13 \strokec13 IChaosController\cf9 \cb1 \strokec9 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls9\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	16.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \{\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls9\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	17.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\cf13 \strokec13 Random\cf9 \strokec9 \'a0rndGen =\'a0\cf12 \strokec12 new\cf9 \strokec9 \'a0\cf13 \strokec13 Random\cf9 \strokec9 ();\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls9\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	18.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls9\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	19.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\cf12 \strokec12 public\cf9 \strokec9 \'a0\cf12 \strokec12 bool\cf9 \strokec9 \'a0ShouldFault(\cf12 \strokec12 ref\cf9 \strokec9 \'a0\cf13 \strokec13 Message\cf9 \strokec9 \'a0request,\'a0\cf12 \strokec12 out\cf9 \strokec9 \'a0\cf13 \strokec13 Message\cf9 \strokec9 \'a0fault)\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls9\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	20.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\{\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls9\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	21.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 if\cf9 \strokec9 \'a0(\cf12 \strokec12 this\cf9 \strokec9 .rndGen.Next(0, 5) == 0)\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls9\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	22.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\{\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls9\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	23.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 var\cf9 \strokec9 \'a0exception =\'a0\cf12 \strokec12 new\cf9 \strokec9 \'a0\cf13 \strokec13 FaultException\cf9 \strokec9 (\cf15 \strokec15 "Chaos!!!"\cf9 \strokec9 ,\'a0\cf12 \strokec12 new\cf9 \strokec9 \'a0\cf13 \strokec13 FaultCode\cf9 \strokec9 (\cf15 \strokec15 "chaos!"\cf9 \strokec9 ));\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls9\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	24.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 var\cf9 \strokec9 \'a0messageFault = exception.CreateMessageFault();\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls9\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	25.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0fault =\'a0\cf13 \strokec13 Message\cf9 \strokec9 .CreateMessage(request.Version, messageFault,\'a0\cf15 \strokec15 "Chaos"\cf9 \strokec9 );\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls9\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	26.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 return\cf9 \strokec9 \'a0\cf12 \strokec12 true\cf9 \strokec9 ;\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls9\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	27.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\}\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls9\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	28.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 else\cf9 \strokec9 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls9\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	29.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\{\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls9\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	30.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0fault =\'a0\cf12 \strokec12 null\cf9 \strokec9 ;\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls9\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	31.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 return\cf9 \strokec9 \'a0\cf12 \strokec12 false\cf9 \strokec9 ;\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls9\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	32.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\}\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls9\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	33.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\}\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls9\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	34.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \}\
\pard\pardeftab720\sl300\sa200\partightenfactor0
\cf9 \cb1 \
\pard\pardeftab720\sl340\sa200\partightenfactor0

\f1\fs28 \cf2 \strokec2 \
\pard\pardeftab720\sl340\sa200\partightenfactor0
\cf2 \cb3 And running the code below, we see that many of the requests to the service throw an exception, just as we wanted. We have chaos!\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls10\ilvl0
\f5\fs26\fsmilli13333 \cf12 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	1.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec12 static\cf9 \strokec9 \'a0\cf12 \strokec12 void\cf9 \strokec9 \'a0Main(\cf12 \strokec12 string\cf9 \strokec9 [] args)\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls10\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	2.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \{\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls10\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	3.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\cf12 \strokec12 string\cf9 \strokec9 \'a0baseAddress =\'a0\cf15 \strokec15 "http://"\cf9 \strokec9 \'a0+\'a0\cf13 \strokec13 Environment\cf9 \strokec9 .MachineName +\'a0\cf15 \strokec15 ":8000/Service"\cf9 \strokec9 ;\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls10\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	4.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\cf13 \strokec13 ServiceHost\cf9 \strokec9 \'a0host =\'a0\cf12 \strokec12 new\cf9 \strokec9 \'a0\cf13 \strokec13 ServiceHost\cf9 \strokec9 (\cf12 \strokec12 typeof\cf9 \strokec9 (\cf13 \strokec13 Service\cf9 \strokec9 ),\'a0\cf12 \strokec12 new\cf9 \strokec9 \'a0\cf13 \strokec13 Uri\cf9 \strokec9 (baseAddress));\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls10\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	5.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\cf13 \strokec13 BasicHttpBinding\cf9 \strokec9 \'a0basicBinding =\'a0\cf12 \strokec12 new\cf9 \strokec9 \'a0\cf13 \strokec13 BasicHttpBinding\cf9 \strokec9 ();\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls10\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	6.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0host.AddServiceEndpoint(\cf12 \strokec12 typeof\cf9 \strokec9 (\cf13 \strokec13 ITest\cf9 \strokec9 ), basicBinding,\'a0\cf15 \strokec15 ""\cf9 \strokec9 );\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls10\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	7.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0host.Open();\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls10\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	8.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\cf13 \strokec13 Console\cf9 \strokec9 .WriteLine(\cf15 \strokec15 "Host opened"\cf9 \strokec9 );\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls10\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	9.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls10\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	10.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\cf13 \strokec13 CustomBinding\cf9 \strokec9 \'a0binding =\'a0\cf12 \strokec12 new\cf9 \strokec9 \'a0\cf13 \strokec13 CustomBinding\cf9 \strokec9 (basicBinding);\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls10\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	11.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\cf13 \strokec13 MyMonkeyController\cf9 \strokec9 \'a0chaosController =\'a0\cf12 \strokec12 new\cf9 \strokec9 \'a0\cf13 \strokec13 MyMonkeyController\cf9 \strokec9 ();\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls10\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	12.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0binding.Elements.Insert(0,\'a0\cf12 \strokec12 new\cf9 \strokec9 \'a0\cf13 \strokec13 ChaosMonkeyBindingElement\cf9 \strokec9 (chaosController));\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls10\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	13.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\cf13 \strokec13 ChannelFactory\cf9 \strokec9 <\cf13 \strokec13 ITest\cf9 \strokec9 > factory =\'a0\cf12 \strokec12 new\cf9 \strokec9 \'a0\cf13 \strokec13 ChannelFactory\cf9 \strokec9 <\cf13 \strokec13 ITest\cf9 \strokec9 >(binding,\'a0\cf12 \strokec12 new\cf9 \strokec9 \'a0\cf13 \strokec13 EndpointAddress\cf9 \strokec9 (baseAddress));\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls10\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	14.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\cf13 \strokec13 ITest\cf9 \strokec9 \'a0proxy = factory.CreateChannel();\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls10\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	15.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls10\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	16.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\cf12 \strokec12 for\cf9 \strokec9 \'a0(\cf12 \strokec12 int\cf9 \strokec9 \'a0i = 0; i < 30; i++)\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls10\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	17.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\{\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls10\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	18.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 try\cf9 \strokec9 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls10\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	19.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\{\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls10\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	20.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf13 \strokec13 Console\cf9 \strokec9 .WriteLine(\cf15 \strokec15 "10 + \{0\} = \{1\}"\cf9 \strokec9 , i, proxy.Add(10, i));\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls10\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	21.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\}\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls10\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	22.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 catch\cf9 \strokec9 \'a0(\cf13 \strokec13 FaultException\cf9 \strokec9 \'a0ex)\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls10\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	23.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\{\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls10\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	24.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf13 \strokec13 Console\cf9 \strokec9 .WriteLine(\cf15 \strokec15 "\{0\}: \{1\}"\cf9 \strokec9 , ex.GetType().Name, ex.Message);\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls10\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	25.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\}\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls10\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	26.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\}\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls10\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	27.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \}\cb1 \
\pard\pardeftab720\sl300\sa200\partightenfactor0
\cf9 \
\pard\pardeftab720\sl340\sa200\partightenfactor0

\f1\fs28 \cf2 \strokec2 \
\pard\pardeftab720\sl340\sa200\partightenfactor0
\cf2 \cb3 Since it worked for a simple HTTP binding, I tried changing it to WSHttpBinding instead of a BasicHttpBinding. And now nothing worked \'96 the channel in the client could not be created! The problem was that while the HTTP transport can only build IRequestChannel instances, WSHttpBinding adds a ReliableMessagingBindingElement to the stack, and it changes the shape to an IRequest
\f4\b Session
\f1\b0 Channel. And we have to go back to the binding element to add support for it again\'85 which means writing a new factory (IChannelFactory<IRequestSessionChannel>) and a new ISessionChannel implementation. And here goes a lot more code\'85 This is the new implementations of [Can]BuildChannelFactory<TChannel> on the binding element.\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls11\ilvl0
\f5\fs26\fsmilli13333 \cf12 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	1.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec12 public\cf9 \strokec9 \'a0\cf12 \strokec12 override\cf9 \strokec9 \'a0\cf12 \strokec12 bool\cf9 \strokec9 \'a0CanBuildChannelFactory<TChannel>(\cf13 \strokec13 BindingContext\cf9 \strokec9 \'a0context)\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls11\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	2.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \{\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls11\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	3.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\cf12 \strokec12 if\cf9 \strokec9 \'a0(context ==\'a0\cf12 \strokec12 null\cf9 \strokec9 )\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls11\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	4.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\{\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls11\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	5.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 throw\cf9 \strokec9 \'a0\cf12 \strokec12 new\cf9 \strokec9 \'a0\cf13 \strokec13 ArgumentNullException\cf9 \strokec9 (\cf15 \strokec15 "context"\cf9 \strokec9 );\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls11\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	6.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\}\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls11\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	7.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls11\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	8.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\cf12 \strokec12 if\cf9 \strokec9 \'a0(\cf12 \strokec12 typeof\cf9 \strokec9 (TChannel) ==\'a0\cf12 \strokec12 typeof\cf9 \strokec9 (\cf13 \strokec13 IRequestChannel\cf9 \strokec9 ) ||\'a0\cf12 \strokec12 typeof\cf9 \strokec9 (TChannel) ==\'a0\cf12 \strokec12 typeof\cf9 \strokec9 (\cf13 \strokec13 IRequestSessionChannel\cf9 \strokec9 ))\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls11\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	9.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\{\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls11\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	10.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 bool\cf9 \strokec9 \'a0innerCanBuild = context.CanBuildInnerChannelFactory<TChannel>();\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls11\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	11.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 return\cf9 \strokec9 \'a0innerCanBuild;\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls11\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	12.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\}\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls11\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	13.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls11\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	14.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\cf12 \strokec12 return\cf9 \strokec9 \'a0\cf12 \strokec12 false\cf9 \strokec9 ;\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls11\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	15.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \}\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls11\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	16.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls11\ilvl0\cf12 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	17.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec12 public\cf9 \strokec9 \'a0\cf12 \strokec12 override\cf9 \strokec9 \'a0\cf13 \strokec13 IChannelFactory\cf9 \strokec9 <TChannel> BuildChannelFactory<TChannel>(\cf13 \strokec13 BindingContext\cf9 \strokec9 \'a0context)\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls11\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	18.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \{\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls11\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	19.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\cf12 \strokec12 if\cf9 \strokec9 \'a0(context ==\'a0\cf12 \strokec12 null\cf9 \strokec9 )\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls11\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	20.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\{\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls11\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	21.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 throw\cf9 \strokec9 \'a0\cf12 \strokec12 new\cf9 \strokec9 \'a0\cf13 \strokec13 ArgumentNullException\cf9 \strokec9 (\cf15 \strokec15 "context"\cf9 \strokec9 );\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls11\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	22.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\}\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls11\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	23.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls11\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	24.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\cf12 \strokec12 if\cf9 \strokec9 \'a0(\cf12 \strokec12 typeof\cf9 \strokec9 (TChannel) !=\'a0\cf12 \strokec12 typeof\cf9 \strokec9 (\cf13 \strokec13 IRequestChannel\cf9 \strokec9 ) &&\'a0\cf12 \strokec12 typeof\cf9 \strokec9 (TChannel) !=\'a0\cf12 \strokec12 typeof\cf9 \strokec9 (\cf13 \strokec13 IRequestSessionChannel\cf9 \strokec9 ))\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls11\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	25.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\{\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls11\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	26.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 throw\cf9 \strokec9 \'a0\cf12 \strokec12 new\cf9 \strokec9 \'a0\cf13 \strokec13 InvalidOperationException\cf9 \strokec9 (\cf15 \strokec15 "Only IRequestChannel / IRequestSessionChannel are supported"\cf9 \strokec9 );\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls11\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	27.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\}\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls11\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	28.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls11\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	29.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\cf12 \strokec12 if\cf9 \strokec9 \'a0(\cf12 \strokec12 typeof\cf9 \strokec9 (TChannel) ==\'a0\cf12 \strokec12 typeof\cf9 \strokec9 (\cf13 \strokec13 IRequestChannel\cf9 \strokec9 ))\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls11\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	30.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\{\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls11\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	31.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 var\cf9 \strokec9 \'a0factory =\'a0\cf12 \strokec12 new\cf9 \strokec9 \'a0\cf13 \strokec13 ChaosMonkeyRequestChannelFactory\cf9 \strokec9 (context.BuildInnerChannelFactory<\cf13 \strokec13 IRequestChannel\cf9 \strokec9 >(),\'a0\cf12 \strokec12 this\cf9 \strokec9 .controller);\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls11\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	32.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 return\cf9 \strokec9 \'a0(\cf13 \strokec13 IChannelFactory\cf9 \strokec9 <TChannel>)factory;\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls11\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	33.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\}\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls11\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	34.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\cf12 \strokec12 else\cf9 \strokec9 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls11\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	35.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\{\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls11\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	36.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 var\cf9 \strokec9 \'a0factory =\'a0\cf12 \strokec12 new\cf9 \strokec9 \'a0\cf13 \strokec13 ChaosMonkeyRequestSessionChannelFactory\cf9 \strokec9 (context.BuildInnerChannelFactory<\cf13 \strokec13 IRequestSessionChannel\cf9 \strokec9 >(),\'a0\cf12 \strokec12 this\cf9 \strokec9 .controller);\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls11\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	37.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\cf12 \strokec12 return\cf9 \strokec9 \'a0(\cf13 \strokec13 IChannelFactory\cf9 \strokec9 <TChannel>)factory;\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls11\ilvl0\cf9 \cb14 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	38.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \'a0\'a0\'a0\'a0\}\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl300\partightenfactor0
\ls11\ilvl0\cf9 \cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	39.	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec9 \}\cb1 \
\pard\pardeftab720\sl300\sa200\partightenfactor0
\cf9 \
\pard\pardeftab720\sl340\sa200\partightenfactor0

\f1\fs28 \cf2 \strokec2 \
\pard\pardeftab720\sl340\sa200\partightenfactor0
\cf2 \cb3 The implementation of the factory and the channel are really similar to the IRequestChannel. But since we\'92re passing an inner factory / channel of a certain type, we can\'92t really reuse much of the code and we end up with a lot of copy/paste code.\cb1 \
\cb3 Finally, channels are powerful. And I\'92ve mentioned it before and will do it again \'96 only use it when no other extensibility points can be used for your needs. But if you really need them, hopefully this post will help you a little in understanding them.\cb1 \
}